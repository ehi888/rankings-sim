<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Fi Weekly Breed Leagues — Simulation</title>
<style>
  :root {
    --blue: #2563EB;
    --green: #16A34A;
    --red: #DC2626;
    --bronze: #CD7F32;
    --silver: #94A3B8;
    --gold: #EAB308;
    --platinum: #6366F1;
    --diamond: #06B6D4;
    --gray-50: #F9FAFB;
    --gray-100: #F3F4F6;
    --gray-200: #E5E7EB;
    --gray-300: #D1D5DB;
    --gray-400: #9CA3AF;
    --gray-500: #6B7280;
    --gray-700: #374151;
    --gray-900: #111827;
  }
  * { margin: 0; padding: 0; box-sizing: border-box; }
  body {
    font-family: -apple-system, BlinkMacSystemFont, 'SF Pro Display', 'Segoe UI', Roboto, sans-serif;
    color: var(--gray-900);
    background: #fff;
    line-height: 1.5;
  }
  .container { max-width: 1100px; margin: 0 auto; padding: 0 24px; }

  /* NAV */
  .top-bar {
    position: sticky; top: 0; z-index: 100;
    background: rgba(255,255,255,0.95); backdrop-filter: blur(8px);
    border-bottom: 1px solid var(--gray-200);
  }
  .top-bar-inner {
    max-width: 1100px; margin: 0 auto; padding: 0 24px;
    display: flex; align-items: center; justify-content: space-between; height: 56px;
  }
  .logo { font-weight: 700; font-size: 15px; color: var(--blue); }
  .nav-tabs { display: flex; gap: 4px; }
  .nav-tab {
    background: none; border: none; padding: 8px 14px; border-radius: 6px;
    font-size: 13px; font-weight: 500; color: var(--gray-500); cursor: pointer;
    transition: all 0.15s;
  }
  .nav-tab:hover { background: var(--gray-100); color: var(--gray-700); }
  .nav-tab.active { background: var(--blue); color: #fff; }

  /* SECTIONS */
  section { padding: 72px 0 48px; }
  .section-label {
    font-size: 12px; font-weight: 600; text-transform: uppercase;
    letter-spacing: 0.08em; color: var(--blue); margin-bottom: 8px;
  }
  .section-title { font-size: 32px; font-weight: 700; margin-bottom: 8px; }
  .section-subtitle { font-size: 16px; color: var(--gray-500); max-width: 640px; margin-bottom: 32px; }

  /* STAT CARDS */
  .stats-grid { display: grid; grid-template-columns: repeat(4, 1fr); gap: 16px; margin-bottom: 40px; }
  .stat-card {
    background: var(--gray-50); border: 1px solid var(--gray-200);
    border-radius: 8px; padding: 20px; text-align: center;
  }
  .stat-value { font-size: 36px; font-weight: 700; color: var(--gray-900); }
  .stat-label { font-size: 13px; color: var(--gray-500); margin-top: 4px; }

  /* PROBLEM-PROOF-SHIP CARDS */
  .pps-card {
    border: 1px solid var(--gray-200); border-radius: 12px;
    overflow: hidden; margin-bottom: 24px;
    box-shadow: 0 1px 3px rgba(0,0,0,0.04);
  }
  .pps-header {
    padding: 20px 24px; border-bottom: 1px solid var(--gray-100);
    display: flex; align-items: center; gap: 12px;
  }
  .pps-header .problem-label {
    font-size: 12px; font-weight: 700; text-transform: uppercase;
    letter-spacing: 0.08em; padding: 4px 10px; border-radius: 4px;
  }
  .pps-header .problem-label.problem { background: #FEE2E2; color: #991B1B; }
  .pps-header .problem-label.proof { background: #DBEAFE; color: #1E40AF; }
  .pps-header .problem-label.ship { background: #D1FAE5; color: #065F46; }
  .pps-header .problem-title { font-size: 17px; font-weight: 600; }
  .pps-body { padding: 24px; }
  .pps-body p { font-size: 14px; color: var(--gray-500); line-height: 1.7; }
  .pps-body blockquote {
    margin: 12px 0; padding: 12px 16px; background: var(--gray-50);
    border-left: 3px solid var(--gray-300); font-style: italic;
    font-size: 14px; color: var(--gray-700);
  }
  .pps-columns { display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 0; }
  .pps-col { padding: 20px 24px; }
  .pps-col:not(:last-child) { border-right: 1px solid var(--gray-100); }
  .pps-col-label {
    font-size: 11px; font-weight: 700; text-transform: uppercase;
    letter-spacing: 0.08em; margin-bottom: 8px;
  }
  .pps-col-label.problem { color: #991B1B; }
  .pps-col-label.proof { color: #1E40AF; }
  .pps-col-label.ship { color: #065F46; }
  .pps-col p, .pps-col li { font-size: 13px; color: var(--gray-500); line-height: 1.6; }
  .pps-col ul { padding-left: 16px; }
  .pps-col li { margin-bottom: 4px; }

  /* TIER BAR */
  .tier-bar-container { margin-bottom: 16px; }
  .tier-bar-container h3 { font-size: 15px; font-weight: 600; margin-bottom: 12px; }
  .tier-bar { display: flex; height: 40px; border-radius: 8px; overflow: hidden; gap: 2px; }
  .tier-seg { display: flex; align-items: center; justify-content: center; color: #fff; font-weight: 700; font-size: 14px; }
  .tier-seg.bronze { background: var(--bronze); }
  .tier-seg.silver { background: var(--silver); }
  .tier-seg.gold { background: var(--gold); color: var(--gray-900); }
  .tier-seg.platinum { background: var(--platinum); }
  .tier-seg.diamond { background: var(--diamond); }
  .tier-legend { display: flex; gap: 20px; margin-top: 12px; flex-wrap: wrap; }
  .tier-legend-item { display: flex; align-items: center; gap: 6px; font-size: 13px; color: var(--gray-500); }
  .tier-dot { width: 10px; height: 10px; border-radius: 50%; }

  /* WEEK TABS */
  .week-tabs { display: flex; gap: 6px; margin-bottom: 24px; position: sticky; top: 56px; z-index: 50; background: var(--gray-50); padding: 12px 0; }
  .week-tab {
    padding: 8px 20px; border-radius: 20px; border: 1px solid var(--gray-200);
    background: #fff; font-size: 14px; font-weight: 500; cursor: pointer;
    transition: all 0.15s;
  }
  .week-tab:hover { border-color: var(--blue); color: var(--blue); }
  .week-tab.active { background: var(--blue); color: #fff; border-color: var(--blue); }

  /* WEEK SUMMARY */
  .week-summary { display: flex; gap: 12px; flex-wrap: wrap; margin-bottom: 16px; }
  .week-chip {
    display: flex; align-items: center; gap: 6px; padding: 6px 14px;
    background: #fff; border: 1px solid var(--gray-200); border-radius: 20px;
    font-size: 13px; color: var(--gray-700);
  }
  .week-chip .dot { width: 8px; height: 8px; border-radius: 50%; }
  .week-outcomes { display: flex; gap: 20px; margin-bottom: 20px; font-size: 14px; }
  .week-outcomes .up { color: var(--green); font-weight: 600; }
  .week-outcomes .hold { color: var(--gray-400); }
  .week-outcomes .down { color: var(--red); font-weight: 600; }

  /* CALLOUT */
  .callout {
    padding: 16px 20px; border-radius: 8px; font-size: 14px; line-height: 1.6;
    margin-bottom: 24px;
  }
  .callout.info { background: #EFF6FF; border: 1px solid #BFDBFE; color: #1E40AF; }
  .callout.warning { background: #FEF3C7; border: 1px solid #FDE68A; color: #92400E; }
  .callout.success { background: #ECFDF5; border: 1px solid #A7F3D0; color: #065F46; }

  /* PHONE FRAME */
  .league-boards { display: flex; gap: 24px; flex-wrap: wrap; justify-content: center; margin-top: 24px; }
  .phone-frame {
    width: 390px; border: 2px solid var(--gray-200); border-radius: 24px;
    overflow: hidden; background: #fff; box-shadow: 0 4px 24px rgba(0,0,0,0.08);
  }
  .phone-header {
    padding: 20px 20px 12px; border-bottom: 1px solid var(--gray-100);
  }
  .league-title { font-size: 17px; font-weight: 700; margin-bottom: 4px; }
  .league-meta { font-size: 12px; color: var(--gray-400); }
  .lb-row {
    display: flex; align-items: center; padding: 10px 20px; gap: 12px;
    border-bottom: 1px solid var(--gray-100); transition: background 0.15s;
  }
  .lb-row.promote { background: #F0FDF4; }
  .lb-row.demote { background: #FEF2F2; }
  .lb-row .rank { width: 28px; font-size: 14px; font-weight: 600; color: var(--gray-400); text-align: center; }
  .lb-row.promote .rank { color: var(--green); }
  .lb-row.demote .rank { color: var(--red); }
  .lb-row .name { flex: 1; font-size: 14px; font-weight: 500; }
  .lb-row .steps { font-size: 13px; color: var(--gray-500); font-variant-numeric: tabular-nums; }
  .lb-row .zone {
    width: 6px; height: 6px; border-radius: 50%;
  }
  .lb-row.promote .zone { background: var(--green); }
  .lb-row.demote .zone { background: var(--red); }
  .lb-ellipsis {
    padding: 8px 20px; text-align: center; font-size: 12px; color: var(--gray-400);
    border-bottom: 1px solid var(--gray-100);
  }
  .phone-footer { padding: 10px 20px; font-size: 11px; color: var(--gray-400); text-align: center; }

  /* JOURNEY CARDS */
  .journey-grid { display: grid; grid-template-columns: repeat(2, 1fr); gap: 20px; }
  .journey-card {
    border: 1px solid var(--gray-200); border-radius: 12px; padding: 24px;
    background: #fff; box-shadow: 0 1px 3px rgba(0,0,0,0.04);
  }
  .journey-card .dog-name { font-size: 20px; font-weight: 700; }
  .journey-card .archetype { font-size: 13px; color: var(--blue); font-weight: 600; margin-bottom: 4px; }
  .journey-card .desc { font-size: 14px; color: var(--gray-500); margin-bottom: 12px; line-height: 1.5; }
  .journey-card .notif {
    background: var(--gray-50); border: 1px solid var(--gray-200);
    border-radius: 8px; padding: 10px 14px; font-size: 13px; color: var(--gray-700);
    margin-bottom: 12px; display: flex; align-items: center; gap: 8px;
  }
  .journey-card .notif-label {
    font-size: 10px; font-weight: 700; text-transform: uppercase;
    letter-spacing: 0.06em; color: var(--blue); white-space: nowrap;
  }
  .journey-timeline { display: flex; align-items: center; gap: 0; }
  .journey-step { text-align: center; }
  .journey-step .badge {
    width: 40px; height: 40px; border-radius: 50%; display: flex;
    align-items: center; justify-content: center; font-size: 18px; margin: 0 auto 4px;
  }
  .journey-step .badge.bronze { background: #FEF3C7; }
  .journey-step .badge.silver { background: #F1F5F9; }
  .journey-step .badge.gold { background: #FEF9C3; }
  .journey-step .badge.platinum { background: #EEF2FF; }
  .journey-step .badge.diamond { background: #ECFEFF; }
  .journey-step .wk { font-size: 11px; color: var(--gray-400); }
  .journey-arrow { color: var(--gray-300); margin: 0 4px; font-size: 16px; padding-bottom: 16px; }

  /* BREED COMPARISON */
  .breed-grid { display: grid; grid-template-columns: repeat(2, 1fr); gap: 24px; margin-bottom: 24px; }
  .breed-card {
    border: 1px solid var(--gray-200); border-radius: 12px; overflow: hidden;
    box-shadow: 0 1px 3px rgba(0,0,0,0.04);
  }
  .breed-card-header {
    display: flex; align-items: center; gap: 12px; padding: 20px;
    border-bottom: 1px solid var(--gray-100);
  }
  .breed-icon { width: 48px; height: 48px; border-radius: 12px; display: flex; align-items: center; justify-content: center; font-size: 24px; }
  .breed-name { font-size: 17px; font-weight: 700; }
  .breed-loc { font-size: 13px; color: var(--gray-400); }
  .breed-card-body { padding: 20px; }
  .breed-row { display: flex; justify-content: space-between; padding: 8px 0; border-bottom: 1px solid var(--gray-100); font-size: 14px; }
  .breed-row:last-child { border-bottom: none; }
  .breed-row .label { color: var(--gray-500); }
  .breed-row .val { font-weight: 600; font-variant-numeric: tabular-nums; }
  .insight-box {
    background: var(--gray-50); border: 1px solid var(--gray-200);
    border-radius: 12px; padding: 24px; margin-top: 8px;
  }
  .insight-box h3 { font-size: 16px; margin-bottom: 8px; }
  .insight-box p { font-size: 14px; color: var(--gray-500); line-height: 1.6; }

  /* POOLING */
  .pooling-visual { display: flex; align-items: center; gap: 32px; margin-bottom: 32px; }
  .city-list {
    flex: 1; border: 1px solid var(--gray-200); border-radius: 12px; padding: 24px;
  }
  .city-list h3 { font-size: 16px; font-weight: 700; margin-bottom: 16px; }
  .city-row { display: flex; align-items: center; gap: 12px; padding: 6px 0; }
  .city-name { width: 100px; font-size: 14px; }
  .city-count { width: 36px; font-size: 14px; font-weight: 600; text-align: right; }
  .city-bar { flex: 1; height: 8px; background: var(--gray-100); border-radius: 4px; overflow: hidden; }
  .city-bar-fill { height: 100%; background: var(--blue); border-radius: 4px; }
  .merge-arrow { display: flex; flex-direction: column; align-items: center; gap: 4px; color: var(--gray-400); }
  .merge-arrow svg { width: 48px; height: 48px; }
  .arrow-label { font-size: 12px; font-weight: 600; text-transform: uppercase; letter-spacing: 0.05em; }
  .merged-result {
    flex: 1; border: 2px solid var(--gold); border-radius: 12px; padding: 24px; text-align: center;
    background: #FFFBEB;
  }
  .merged-title { font-size: 18px; font-weight: 700; }
  .merged-subtitle { font-size: 13px; color: var(--gray-500); margin-bottom: 16px; }
  .merged-stats { display: flex; justify-content: center; gap: 32px; }
  .merged-stat .num { font-size: 28px; font-weight: 700; color: var(--gray-900); }
  .merged-stat .lbl { font-size: 12px; color: var(--gray-500); }

  .pooling-tiers { display: flex; gap: 16px; margin-bottom: 16px; }
  .pooling-tier-card {
    flex: 1; border: 2px solid var(--gray-200); border-radius: 12px; padding: 20px; text-align: center;
  }
  .pooling-tier-card .tier-name { font-size: 16px; font-weight: 700; margin-bottom: 4px; }
  .pooling-tier-card .tier-calc { font-size: 13px; color: var(--gray-400); }
  .pooling-tier-card .tier-result { font-size: 24px; font-weight: 700; margin: 8px 0; }
  .tier-verdict { font-size: 12px; font-weight: 600; text-transform: uppercase; letter-spacing: 0.05em; }
  .tier-verdict.healthy { color: var(--green); }
  .tier-verdict.small { color: var(--gold); }

  /* WHAT WE SHIP */
  .ship-grid { display: grid; grid-template-columns: repeat(2, 1fr); gap: 20px; margin-top: 24px; }
  .ship-card {
    border: 1px solid var(--gray-200); border-radius: 12px; padding: 24px;
    background: #fff; box-shadow: 0 1px 3px rgba(0,0,0,0.04);
  }
  .ship-card h3 { font-size: 16px; font-weight: 700; margin-bottom: 4px; }
  .ship-card .ship-type { font-size: 12px; font-weight: 600; text-transform: uppercase; letter-spacing: 0.06em; margin-bottom: 8px; }
  .ship-card .ship-type.backend { color: var(--platinum); }
  .ship-card .ship-type.frontend { color: var(--blue); }
  .ship-card .ship-type.notifications { color: var(--green); }
  .ship-card .ship-type.data { color: var(--bronze); }
  .ship-card p { font-size: 13px; color: var(--gray-500); line-height: 1.6; }
  .ship-card ul { padding-left: 16px; margin-top: 8px; }
  .ship-card li { font-size: 13px; color: var(--gray-500); line-height: 1.6; margin-bottom: 4px; }

  /* FOOTER */
  .footer {
    text-align: center; padding: 48px 24px; font-size: 13px; color: var(--gray-400);
    border-top: 1px solid var(--gray-100);
  }

  @media (max-width: 768px) {
    .stats-grid { grid-template-columns: repeat(2, 1fr); }
    .journey-grid { grid-template-columns: 1fr; }
    .breed-grid { grid-template-columns: 1fr; }
    .pooling-visual { flex-direction: column; }
    .pooling-tiers { flex-direction: column; }
    .nav-tabs { display: none; }
    .pps-columns { grid-template-columns: 1fr; }
    .pps-col:not(:last-child) { border-right: none; border-bottom: 1px solid var(--gray-100); }
    .ship-grid { grid-template-columns: 1fr; }
  }
</style>
</head>
<body>

<nav class="top-bar">
  <div class="top-bar-inner">
    <div class="logo">Fi Leagues Simulator</div>
    <div class="nav-tabs">
      <button class="nav-tab active" onclick="navJump('simulation')">Overview</button>
      <button class="nav-tab" onclick="navJump('problems')">Problems Solved</button>
      <button class="nav-tab" onclick="navJump('weekview')">Week by Week</button>
      <button class="nav-tab" onclick="navJump('pooling')">How It Scales</button>
      <button class="nav-tab" onclick="navJump('journeys')">User Stories</button>
      <button class="nav-tab" onclick="navJump('ship')">What We Ship</button>
    </div>
  </div>
</nav>

<!-- SECTION 1: OVERVIEW -->
<section id="simulation">
  <div class="container">
    <div class="section-label">The Simulation</div>
    <div class="section-subtitle">
      Ran 83 real Golden Retrievers in Austin, TX through 4 weeks of league play
      using their actual step data (Jan 19 &ndash; Feb 15, 2026).
    </div>
    <div class="stats-grid">
      <div class="stat-card"><div class="stat-value">83</div><div class="stat-label">Dogs in simulation</div></div>
      <div class="stat-card"><div class="stat-value">4</div><div class="stat-label">Weeks of real data</div></div>
      <div class="stat-card"><div class="stat-value">97K</div><div class="stat-label">Median steps/week</div></div>
      <div class="stat-card"><div class="stat-value" id="statTiers">5</div><div class="stat-label">Tiers reached</div></div>
    </div>

    <!-- PARAMETER CONTROLS -->
    <div style="border:1px solid var(--gray-200);border-radius:12px;padding:24px;margin-bottom:24px;background:#fff;">
      <div style="display:flex;align-items:center;justify-content:space-between;margin-bottom:16px;">
        <h3 style="font-size:15px;font-weight:600;">Adjust Parameters</h3>
        <button id="resetBtn" onclick="resetParams()" style="background:none;border:1px solid var(--gray-200);border-radius:6px;padding:4px 12px;font-size:12px;color:var(--gray-500);cursor:pointer;">Reset to default</button>
      </div>
      <div style="display:grid;grid-template-columns:1fr 1fr;gap:24px;">
        <div>
          <div style="display:flex;justify-content:space-between;margin-bottom:8px;">
            <span style="font-size:13px;font-weight:500;color:var(--gray-700);">League size</span>
            <span id="leagueSizeVal" style="font-size:13px;font-weight:700;color:var(--blue);">38</span>
          </div>
          <input type="range" id="leagueSize" min="15" max="60" value="38" style="width:100%;accent-color:var(--blue);" oninput="recalc()">
          <div style="display:flex;justify-content:space-between;font-size:11px;color:var(--gray-400);margin-top:2px;">
            <span>15</span><span>60</span>
          </div>
        </div>
        <div>
          <div style="display:flex;justify-content:space-between;margin-bottom:8px;">
            <span style="font-size:13px;font-weight:500;color:var(--gray-700);">Promotion rate</span>
            <span id="promoRateVal" style="font-size:13px;font-weight:700;color:var(--green);">20%</span>
          </div>
          <input type="range" id="promoRate" min="5" max="35" value="20" style="width:100%;accent-color:var(--green);" oninput="recalc()">
          <div style="display:flex;justify-content:space-between;font-size:11px;color:var(--gray-400);margin-top:2px;">
            <span>5%</span><span>35%</span>
          </div>
        </div>
      </div>
    </div>

    <div class="tier-bar-container">
      <h3 style="display:flex;align-items:center;gap:8px;">Tier Distribution After 4 Weeks <span id="paramNote" style="font-size:12px;font-weight:400;color:var(--gray-400);display:none;">(simulated)</span></h3>
      <div class="tier-bar" id="tierBar">
        <div class="tier-seg bronze" style="flex:53">44</div>
        <div class="tier-seg silver" style="flex:34">28</div>
        <div class="tier-seg gold" style="flex:10.8">9</div>
        <div class="tier-seg platinum" style="flex:1.5"></div>
        <div class="tier-seg diamond" style="flex:1.5"></div>
      </div>
      <div class="tier-legend" id="tierLegend">
        <div class="tier-legend-item"><div class="tier-dot" style="background:var(--bronze)"></div> Bronze <strong>44</strong> (53%)</div>
        <div class="tier-legend-item"><div class="tier-dot" style="background:var(--silver)"></div> Silver <strong>28</strong> (34%)</div>
        <div class="tier-legend-item"><div class="tier-dot" style="background:var(--gold)"></div> Gold <strong>9</strong> (11%)</div>
        <div class="tier-legend-item"><div class="tier-dot" style="background:var(--platinum)"></div> Platinum <strong>1</strong> (1.2%)</div>
        <div class="tier-legend-item"><div class="tier-dot" style="background:var(--diamond)"></div> Diamond <strong>1</strong> (1.2%)</div>
      </div>
      <div id="paramInsight" style="margin-top:16px;font-size:13px;color:var(--gray-500);line-height:1.6;display:none;"></div>
      <div style="margin-top:20px;text-align:center;">
        <button onclick="navJump('pooling')" style="background:none;border:1px solid var(--gray-200);border-radius:8px;padding:8px 20px;font-size:13px;color:var(--gray-600);cursor:pointer;transition:all .15s;">See how it scales &darr;</button>
      </div>
    </div>
  </div>
</section>

<!-- SECTION 2: PROBLEMS SOLVED -->
<section id="problems" style="background: var(--gray-50);">
  <div class="container">
    <div class="section-label">What Leagues Fix</div>
    <div class="section-title">Problem &rarr; Proof &rarr; What We Ship</div>
    <div class="section-subtitle">Each problem from our CX data, what the simulation proved, and what we build to fix it.</div>

    <!-- Stagnation -->
    <div class="pps-card">
      <div class="pps-columns">
        <div class="pps-col">
          <div class="pps-col-label problem">Problem: Stagnation</div>
          <p>A dog at 840K rolling steps gains 30K and drops 30K daily = net zero visible change. Rank doesn't move.</p>
          <blockquote>"My dog walks every day and the ranking never changes."</blockquote>
        </div>
        <div class="pps-col">
          <div class="pps-col-label proof">Simulation Proved</div>
          <p>Every dog changed position every week. 17 dogs promoted and 6 demoted in Week 4 alone. Telli went Bronze &rarr; Silver &rarr; Gold &rarr; Silver &rarr; Gold. Zero stagnation.</p>
        </div>
        <div class="pps-col">
          <div class="pps-col-label ship">What We Ship</div>
          <ul>
            <li>Weekly reset (Monday 12am)</li>
            <li>Tier progression (Bronze &rarr; Diamond)</li>
            <li>End-of-week push: "Bowery promoted to Silver!"</li>
          </ul>
        </div>
      </div>
    </div>

    <!-- New users -->
    <div class="pps-card">
      <div class="pps-columns">
        <div class="pps-col">
          <div class="pps-col-label problem">Problem: New Users Buried</div>
          <p>A dog joining today is mathematically buried for 28 days. No reason to engage with rankings.</p>
          <blockquote>"We just got our collar and we're already ranked last. What's the point?"</blockquote>
        </div>
        <div class="pps-col">
          <div class="pps-col-label proof">Simulation Proved</div>
          <p>Every Monday, every dog starts at zero. In Week 1, all 83 dogs had an equal shot. By Friday, league positions were already meaningful and competitive.</p>
        </div>
        <div class="pps-col">
          <div class="pps-col-label ship">What We Ship</div>
          <ul>
            <li>Fixed weekly window (not rolling)</li>
            <li>New dogs placed in Bronze league immediately</li>
            <li>Mid-week nudge: "You're #8 with 3 days left"</li>
          </ul>
        </div>
      </div>
    </div>

    <!-- Cheating -->
    <div class="pps-card">
      <div class="pps-columns">
        <div class="pps-col">
          <div class="pps-col-label problem">Problem: Cheating Suspicion</div>
          <p>250K daily step counts at the top look illegitimate. Users lose trust in the entire system.</p>
          <blockquote>"A lot of folks will just disregard it."</blockquote>
        </div>
        <div class="pps-col">
          <div class="pps-col-label proof">Simulation Proved</div>
          <p>In a 38-dog Bronze league, the top dog had 196K weekly (28K/day) &mdash; totally plausible for a Golden Retriever. The top of your league is your neighbor's dog.</p>
        </div>
        <div class="pps-col">
          <div class="pps-col-label ship">What We Ship</div>
          <ul>
            <li>Leagues of 30&ndash;50 dogs by breed</li>
            <li>Breed-specific competition (not global)</li>
            <li>Outliers naturally separate into higher tiers</li>
          </ul>
        </div>
      </div>
    </div>

    <!-- Flat leaderboard -->
    <div class="pps-card">
      <div class="pps-columns">
        <div class="pps-col">
          <div class="pps-col-label problem">Problem: Flat Leaderboard</div>
          <p>Being #347 of 821 Brooklyn Dogs doesn't feel like anything. Moving to #300 is invisible progress.</p>
          <blockquote>"Steps should be compared by week or at least month."</blockquote>
        </div>
        <div class="pps-col">
          <div class="pps-col-label proof">Simulation Proved</div>
          <p>Instead of #347/821, Watson was #2 of 6 in Gold League by Week 4. Top-3 in your league is achievable. Tier badges (Gold, Platinum) are visible status markers.</p>
        </div>
        <div class="pps-col">
          <div class="pps-col-label ship">What We Ship</div>
          <ul>
            <li>League view as default (not full group)</li>
            <li>Tier badges on profiles and group cards</li>
            <li>Top-3 carousel shows your league</li>
            <li>Share card with tier + league position</li>
          </ul>
        </div>
      </div>
    </div>
  </div>
</section>

<!-- SECTION 3: WEEK BY WEEK -->
<section id="weekview">
  <div class="container">
    <div class="section-label">Week by Week</div>
    <div class="section-title">4 Weeks of Real League Play</div>
    <div class="section-subtitle">Click each week to see how leagues formed, dogs competed, and tiers emerged.</div>
    <div class="week-tabs">
      <button class="week-tab active" onclick="showWeek(1)">Week 1</button>
      <button class="week-tab" onclick="showWeek(2)">Week 2</button>
      <button class="week-tab" onclick="showWeek(3)">Week 3</button>
      <button class="week-tab" onclick="showWeek(4)">Week 4</button>
    </div>
    <div id="weekContent"></div>
  </div>
</section>

<!-- SECTION 4: HOW IT SCALES -->
<section id="pooling">
  <div class="container">
    <div class="section-label">How It Scales</div>
    <div class="section-title">A Standardized System of Competition</div>
    <div class="section-subtitle">By Week 4, Austin's Gold League had only 6 dogs — and Finn was alone in Platinum. If a tier has too few dogs locally, it widens to a regional or national league.</div>
    <div class="callout warning">
      <strong>You saw this in Week 3:</strong> Gold League had only 3 dogs. By Week 4, Finn was alone in Platinum.
      When a tier gets too thin locally, the league widens &mdash; from city to state to national &mdash; until there's a competitive group.
    </div>
    <div class="pooling-visual">
      <div class="city-list">
        <h3>Texas Golden Retrievers</h3>
        <div class="city-row"><span class="city-name">Austin</span><span class="city-count">117</span><div class="city-bar"><div class="city-bar-fill" style="width:100%"></div></div></div>
        <div class="city-row"><span class="city-name">Houston</span><span class="city-count">56</span><div class="city-bar"><div class="city-bar-fill" style="width:48%"></div></div></div>
        <div class="city-row"><span class="city-name">Dallas</span><span class="city-count">51</span><div class="city-bar"><div class="city-bar-fill" style="width:44%"></div></div></div>
        <div class="city-row"><span class="city-name">Fort Worth</span><span class="city-count">32</span><div class="city-bar"><div class="city-bar-fill" style="width:27%"></div></div></div>
        <div class="city-row"><span class="city-name">San Antonio</span><span class="city-count">29</span><div class="city-bar"><div class="city-bar-fill" style="width:25%"></div></div></div>
        <div class="city-row" style="padding-top:12px;border-top:1px solid var(--gray-200);margin-top:8px;">
          <span class="city-name" style="font-weight:700">Total Texas</span>
          <span class="city-count" style="font-size:16px;font-weight:700">~500</span>
          <div class="city-bar" style="visibility:hidden"></div>
        </div>
      </div>
      <div class="merge-arrow">
        <svg viewBox="0 0 48 48" fill="none" stroke="currentColor" stroke-width="2" width="48" height="48">
          <line x1="8" y1="24" x2="36" y2="24"/><polyline points="28,16 36,24 28,32"/>
        </svg>
        <span class="arrow-label">Pool Gold+</span>
      </div>
      <div class="merged-result">
        <div class="merged-title">Texas Golden Retrievers</div>
        <div class="merged-subtitle">Gold League & Above</div>
        <div class="merged-stats">
          <div class="merged-stat"><div class="num">~500</div><div class="lbl">active dogs</div></div>
          <div class="merged-stat"><div class="num">42</div><div class="lbl">Gold tier (8.4%)</div></div>
          <div class="merged-stat"><div class="num">6</div><div class="lbl">Platinum (1.2%)</div></div>
        </div>
      </div>
    </div>
    <div class="pooling-tiers">
      <div class="pooling-tier-card" style="border-color:var(--gold)">
        <div class="tier-name" style="color:var(--gold)">Gold League</div>
        <div class="tier-calc">~500 x 8.4%</div>
        <div class="tier-result">~42 dogs</div>
        <div class="tier-verdict healthy">Healthy league</div>
      </div>
      <div class="pooling-tier-card" style="border-color:var(--platinum)">
        <div class="tier-name" style="color:var(--platinum)">Platinum League</div>
        <div class="tier-calc">~500 x 1.2%</div>
        <div class="tier-result">~6 dogs</div>
        <div class="tier-verdict small">Small but competitive</div>
      </div>
      <div class="pooling-tier-card" style="border-color:var(--diamond)">
        <div class="tier-name" style="color:var(--diamond)">Diamond League</div>
        <div class="tier-calc">Pool nationally</div>
        <div class="tier-result">Top breed dogs</div>
        <div class="tier-verdict small">National breed league</div>
      </div>
    </div>
    <div class="callout success" style="margin-top:24px">
      <strong>The rule:</strong> Bronze & Silver compete locally (Austin Golden Retrievers).
      Gold+ competes regionally (Texas Golden Retrievers).
      Diamond competes nationally (Golden Retrievers USA). Every dog always has a competitive league.
    </div>
  </div>
</section>

<!-- SECTION 5: USER STORIES -->
<section id="journeys" style="background: var(--gray-50);">
  <div class="container">
    <div class="section-label">User Stories</div>
    <div class="section-title">What the Owner Experiences</div>
    <div class="section-subtitle">Four dogs, four journeys. Each one generates push notifications, share moments, and reasons to come back Monday.</div>
    <div class="journey-grid" id="journeyGrid"></div>
  </div>
</section>

<!-- SECTION 6: BREED AUTO-CALIBRATION -->
<section id="breeds" style="background: var(--gray-50);">
  <div class="container">
    <div class="section-label">Auto-Calibration</div>
    <div class="section-title">Works Across Breeds, Zero Tuning</div>
    <div class="section-subtitle">Percentile-based tiers automatically calibrate to each breed's activity level.</div>
    <div class="breed-grid">
      <div class="breed-card">
        <div class="breed-card-header">
          <div class="breed-icon" style="background:#FEF3C7;">&#x1F415;</div>
          <div><div class="breed-name">Golden Retriever</div><div class="breed-loc">Austin, TX &mdash; 83 dogs</div></div>
        </div>
        <div class="breed-card-body">
          <div class="breed-row"><span class="label">Median</span><span class="val">97,445 steps/wk</span></div>
          <div class="breed-row"><span class="label">P25</span><span class="val">57,194 steps/wk</span></div>
          <div class="breed-row"><span class="label">P75</span><span class="val">134,130 steps/wk</span></div>
          <div class="breed-row"><span class="label" style="color:var(--bronze)">Bronze avg</span><span class="val">64,759/wk</span></div>
          <div class="breed-row"><span class="label" style="color:var(--silver)">Silver avg</span><span class="val">134,198/wk</span></div>
          <div class="breed-row"><span class="label" style="color:var(--gold)">Gold avg</span><span class="val">158,957/wk</span></div>
        </div>
      </div>
      <div class="breed-card">
        <div class="breed-card-header">
          <div class="breed-icon" style="background:#FCE7F3;">&#x1F436;</div>
          <div><div class="breed-name">Chihuahua</div><div class="breed-loc">Los Angeles, CA &mdash; 80 dogs</div></div>
        </div>
        <div class="breed-card-body">
          <div class="breed-row"><span class="label">Median</span><span class="val">~106,000 steps/wk</span></div>
          <div class="breed-row"><span class="label">P25</span><span class="val">~55,000 steps/wk</span></div>
          <div class="breed-row"><span class="label">P75</span><span class="val">~140,000 steps/wk</span></div>
          <div class="breed-row"><span class="label" style="color:var(--bronze)">Bronze avg</span><span class="val">~62,000/wk</span></div>
          <div class="breed-row"><span class="label" style="color:var(--silver)">Silver avg</span><span class="val">~128,000/wk</span></div>
          <div class="breed-row"><span class="label" style="color:var(--gold)">Gold avg</span><span class="val">~165,000/wk</span></div>
        </div>
      </div>
    </div>
    <div class="insight-box">
      <h3>Why This Matters for Engineering</h3>
      <p>A Gold-tier Chihuahua and a Gold-tier Golden Retriever both earned their rank by being
      <strong>top performers of their breed</strong>. The percentile-based system means no manual thresholds,
      no breed-specific configuration, no seasonal adjustments. Winter step counts drop across the board &mdash;
      thresholds adjust automatically. <strong>Add a new breed? It just works.</strong></p>
    </div>
  </div>
</section>

<!-- SECTION 7: WHAT WE SHIP -->
<section id="ship">
  <div class="container">
    <div class="section-label">What We Ship</div>
    <div class="section-title">From Simulation to Product</div>
    <div class="section-subtitle">Everything the simulation validated, mapped to what engineering builds.</div>

    <div class="ship-grid">
      <div class="ship-card">
        <div class="ship-type backend">Backend</div>
        <h3>League Assignment Service</h3>
        <p>Weekly batch job that assigns dogs to leagues of 30&ndash;50 by breed, city/region, and tier.</p>
        <ul>
          <li>Runs Monday 12am UTC</li>
          <li>Groups by breed + metro + tier</li>
          <li>Randomizes within group to form leagues</li>
          <li>Gold+ pools regionally, Diamond nationally</li>
        </ul>
      </div>
      <div class="ship-card">
        <div class="ship-type backend">Backend</div>
        <h3>Promotion Engine</h3>
        <p>Sunday night job that locks positions and calculates promotions/demotions.</p>
        <ul>
          <li>Top 20% promote, bottom 20% demote</li>
          <li>Percentile-based = auto-calibrating</li>
          <li>Writes tier changes to dog profile</li>
          <li>Triggers push notification events</li>
        </ul>
      </div>
      <div class="ship-card">
        <div class="ship-type frontend">Frontend</div>
        <h3>League UI</h3>
        <p>Builds on Jena's Place Group designs. League is the default view within a group.</p>
        <ul>
          <li>League leaderboard (30&ndash;50 dogs)</li>
          <li>Tier badge on group cards + profiles</li>
          <li>Top-3 carousel = your league, not global</li>
          <li>Promotion/demotion zone indicators</li>
        </ul>
      </div>
      <div class="ship-card">
        <div class="ship-type notifications">Notifications</div>
        <h3>Engagement Moments</h3>
        <p>Each moment the simulation created maps to a push or share opportunity.</p>
        <ul>
          <li>"Bowery promoted to Silver!" (end of week)</li>
          <li>"You're #5 with 2 days left" (mid-week nudge)</li>
          <li>"Bowery's best week ever!" (personal best)</li>
          <li>Share card: tier + position + steps</li>
        </ul>
      </div>
      <div class="ship-card">
        <div class="ship-type data">Data / Infrastructure</div>
        <h3>ClickHouse Query Layer</h3>
        <p>Leagues are WHERE clauses on the new ClickHouse infrastructure Tim is building.</p>
        <ul>
          <li><code>breed = 'Golden Retriever' AND metro = 'Austin' AND tier = 'Gold'</code></li>
          <li>New dimension = new WHERE clause, not new pipeline</li>
          <li>Firehose stream needs breed, city, tier dimensions</li>
          <li>Weekly aggregation via materialized views</li>
        </ul>
      </div>
      <div class="ship-card">
        <div class="ship-type data">Data / Infrastructure</div>
        <h3>What Already Exists</h3>
        <p>We're not starting from zero. Existing infrastructure supports this.</p>
        <ul>
          <li><code>rankPercentile</code> already in the pipeline</li>
          <li>Breed + city data in dim_pets</li>
          <li>Activity data flowing via Kinesis Firehose</li>
          <li>ClickHouse POC underway (Tim's Milestone 1)</li>
        </ul>
      </div>
    </div>
  </div>
</section>

<footer class="footer">
  Built with real Fi data &mdash; 83 Golden Retrievers, Austin TX, Jan 19 &ndash; Feb 15, 2026<br>
  <span style="color:var(--gray-300)">Internal demo &middot; Rankings Revamp Phase 2</span>
</footer>

<script>
// PARAMETER PLAYGROUND
(function() {
  var TOTAL = 83;
  var WEEKS = 4;
  var defaults = {leagueSize: 38, promoRate: 20};

  function simulate(leagueSize, promoRate) {
    var tiers = [TOTAL, 0, 0, 0, 0]; // bronze, silver, gold, plat, diamond
    var names = ['Bronze','Silver','Gold','Platinum','Diamond'];
    for (var w = 0; w < WEEKS; w++) {
      var newTiers = [0, 0, 0, 0, 0];
      for (var t = 0; t < 5; t++) {
        if (tiers[t] === 0) continue;
        // Split tier into leagues
        var numLeagues = Math.max(1, Math.round(tiers[t] / leagueSize));
        var remaining = tiers[t];
        var totalPromote = 0, totalDemote = 0;
        for (var l = 0; l < numLeagues; l++) {
          var lgSize = Math.round(remaining / (numLeagues - l));
          remaining -= lgSize;
          var pN = Math.max(1, Math.round(lgSize * promoRate / 100));
          var dN = t > 0 ? Math.max(1, Math.round(lgSize * promoRate / 100)) : 0;
          if (t === 4) pN = 0;
          if (t === 0) dN = 0;
          // Conservation: can't move more dogs than exist
          if (pN + dN > lgSize) { pN = Math.min(pN, lgSize); dN = Math.min(dN, lgSize - pN); }
          totalPromote += pN;
          totalDemote += dN;
        }
        var stay = tiers[t] - totalPromote - totalDemote;
        newTiers[t] += stay;
        if (t < 4) newTiers[t + 1] += totalPromote;
        if (t > 0) newTiers[t - 1] += totalDemote;
      }
      tiers = newTiers;
    }
    return tiers.map(function(n, i) { return {name: names[i], count: n}; });
  }

  window.recalc = function() {
    var ls = parseInt(document.getElementById('leagueSize').value);
    var pr = parseInt(document.getElementById('promoRate').value);
    document.getElementById('leagueSizeVal').textContent = ls;
    document.getElementById('promoRateVal').textContent = pr + '%';

    var result = simulate(ls, pr);
    var total = result.reduce(function(s, r) { return s + r.count; }, 0);
    var colors = ['bronze','silver','gold','platinum','diamond'];

    // Update tier bar
    var barHtml = '';
    result.forEach(function(r, i) {
      var pct = (r.count / total * 100);
      if (r.count > 0) {
        barHtml += '<div class="tier-seg ' + colors[i] + '" style="flex:' + Math.max(pct, 1.5) + '">' + (r.count > 2 ? r.count : '') + '</div>';
      }
    });
    document.getElementById('tierBar').innerHTML = barHtml;

    // Update legend
    var legHtml = '';
    result.forEach(function(r, i) {
      var pct = (r.count / total * 100).toFixed(1);
      legHtml += '<div class="tier-legend-item"><div class="tier-dot" style="background:var(--' + colors[i] + ')"></div> ' + r.name + ' <strong>' + r.count + '</strong> (' + pct + '%)</div>';
    });
    document.getElementById('tierLegend').innerHTML = legHtml;

    // Count tiers reached
    var tiersReached = result.filter(function(r) { return r.count > 0; }).length;
    document.getElementById('statTiers').textContent = tiersReached;

    // Show param note + insight
    var isDefault = (ls === defaults.leagueSize && pr === defaults.promoRate);
    document.getElementById('paramNote').style.display = isDefault ? 'none' : 'inline';
    var insightEl = document.getElementById('paramInsight');
    if (isDefault) {
      insightEl.style.display = 'none';
    } else {
      insightEl.style.display = 'block';
      var goldCount = result[2].count;
      var platCount = result[3].count;
      var insights = [];
      if (pr > 25) insights.push('Higher promotion rate means faster tier movement but thinner upper tiers.');
      if (pr < 15) insights.push('Lower promotion rate keeps most dogs in Bronze/Silver longer — slower progression but denser leagues.');
      if (ls < 25) insights.push('Smaller leagues mean more personal competition but more leagues to manage.');
      if (ls > 45) insights.push('Larger leagues mean fewer total leagues but less chance of being in the top 3.');
      if (goldCount < 3) insights.push('Gold has only ' + goldCount + ' dog' + (goldCount !== 1 ? 's' : '') + ' — regional pooling would kick in here.');
      if (platCount === 0 && pr < 15) insights.push('No dogs reach Platinum at this promotion rate in 4 weeks.');
      insightEl.innerHTML = insights.join(' ');
    }
  };

  window.resetParams = function() {
    document.getElementById('leagueSize').value = defaults.leagueSize;
    document.getElementById('promoRate').value = defaults.promoRate;
    recalc();
  };
})();

(function() {
  function fmt(n) { return n.toLocaleString('en-US'); }

  var WEEKS = {
    1: {
      chips: [{tier:'Bronze',color:'var(--bronze)',text:'Bronze: 2 leagues (42 + 41 dogs)'}],
      outcomes: {up:16, stay:67, down:0},
      callout: null,
      leagues: [
        { name:'Bronze League 1', tier:'Bronze', size:42, promoteN:8, demoteN:0,
          top:[
            {r:1,n:'Maddie',s:196447},{r:2,n:'Dusty',s:160404},{r:3,n:'Murphy',s:160315},
            {r:4,n:'Jackson',s:158599},{r:5,n:'Goatmaster General',s:154339},
            {r:6,n:'Stella',s:139047},{r:7,n:'Lily',s:139259}
          ],
          bot:[
            {r:37,n:'Finn B',s:42299},{r:38,n:'Ollie',s:31048},{r:39,n:'Arlo',s:29136},
            {r:40,n:'Alaska',s:23351},{r:41,n:'Moose',s:13277},{r:42,n:'Mason',s:6001}
          ]
        },
        { name:'Bronze League 2', tier:'Bronze', size:41, promoteN:8, demoteN:0,
          top:[
            {r:1,n:'Finn',s:244055},{r:2,n:'Telli',s:205658},{r:3,n:'Winnie B',s:194077},
            {r:4,n:'Bowie',s:161996},{r:5,n:'River',s:160223},{r:6,n:'Casey',s:141809}
          ],
          bot:[
            {r:36,n:'Etsy',s:33555},{r:37,n:'Zoey',s:28947},{r:38,n:'Juniper',s:24389},
            {r:39,n:'Honey',s:22623},{r:40,n:'Ozzy',s:18599},{r:41,n:'Jessie',s:14182}
          ]
        }
      ]
    },
    2: {
      chips: [
        {tier:'Bronze',color:'var(--bronze)',text:'Bronze: 2 leagues (34 + 33 dogs)'},
        {tier:'Silver',color:'var(--silver)',text:'Silver: 1 league (16 dogs)'}
      ],
      outcomes: {up:17, stay:63, down:3},
      callout: {type:'info', html:"Week 1's top 16 promoted into a fresh Silver League. They now compete against each other."},
      leagues: [
        { name:'Silver League', tier:'Silver', size:16, promoteN:3, demoteN:3,
          top:[
            {r:1,n:'Finn',s:251224},{r:2,n:'Telli',s:228183},{r:3,n:'Winnie B',s:211637},
            {r:4,n:'Maddie',s:207562},{r:5,n:'Bowie',s:181042}
          ],
          bot:[
            {r:13,n:'Stella',s:119781},{r:14,n:'Lily',s:36907},
            {r:15,n:'Bailey',s:28503},{r:16,n:'Tucker',s:19217}
          ]
        }
      ]
    },
    3: {
      chips: [
        {tier:'Bronze',color:'var(--bronze)',text:'Bronze: 2 leagues (28 each)'},
        {tier:'Silver',color:'var(--silver)',text:'Silver: 1 league (24 dogs)'},
        {tier:'Gold',color:'var(--gold)',text:'Gold: 1 league (3 dogs)'}
      ],
      outcomes: {up:18, stay:59, down:6},
      callout: {type:'warning', html:'<strong>The thin-tier problem appears.</strong> Gold League has only 3 dogs. Finn promotes, Telli demotes. This is exactly why higher tiers pool regionally.'},
      leagues: [
        { name:'Gold League', tier:'Gold', size:3, promoteN:1, demoteN:1,
          top:[{r:1,n:'Finn',s:246349}],
          bot:[{r:2,n:'Winnie B',s:190817},{r:3,n:'Telli',s:173245}]
        }
      ]
    },
    4: {
      chips: [
        {tier:'Bronze',color:'var(--bronze)',text:'Bronze: 1 league (49 dogs)'},
        {tier:'Silver',color:'var(--silver)',text:'Silver: 1 league (27 dogs)'},
        {tier:'Gold',color:'var(--gold)',text:'Gold: 1 league (6 dogs)'},
        {tier:'Platinum',color:'var(--platinum)',text:'Platinum: 1 dog'}
      ],
      outcomes: {up:17, stay:60, down:6},
      callout: {type:'warning', html:"<strong>Finn is alone in Platinum.</strong> He auto-promotes to Diamond. Without regional pooling, there's nobody to compete against at the top."},
      leagues: [
        { name:'Gold League', tier:'Gold', size:6, promoteN:1, demoteN:1,
          top:[{r:1,n:'Winnie B',s:192151},{r:2,n:'Watson',s:184852},{r:3,n:'Goatmaster General',s:156785}],
          bot:[{r:4,n:'Eros',s:140465},{r:5,n:'Bowie',s:138210},{r:6,n:'Dusty',s:120847}]
        },
        { name:'Platinum League', tier:'Platinum', size:1, promoteN:1, demoteN:0,
          top:[{r:1,n:'Finn',s:234936}],
          bot:[]
        }
      ]
    }
  };

  function renderLeague(lg) {
    var h = '<div class="phone-frame"><div style="padding:0">';
    h += '<div class="phone-header"><div class="league-title">' +
      (lg.tier==='Bronze'?'&#x1F949;':lg.tier==='Silver'?'&#x1F948;':lg.tier==='Gold'?'&#x1F947;':lg.tier==='Platinum'?'&#x1F48E;':'&#x1F451;') +
      ' ' + lg.name + '</div>';
    h += '<div class="league-meta">' + lg.size + ' dog' + (lg.size!==1?'s':'') + ' &middot; Top 20% promote &middot; Bottom 20% demote</div></div>';

    lg.top.forEach(function(d) {
      var pro = d.r <= lg.promoteN;
      h += '<div class="lb-row' + (pro?' promote':'') + '">';
      h += '<span class="rank">' + d.r + '</span><span class="name">' + d.n + '</span>';
      h += '<span class="steps">' + fmt(d.s) + '</span>';
      h += '<div class="zone"' + (pro?'':' style="background:transparent"') + '></div></div>';
    });

    if (lg.bot.length && lg.top.length) {
      var gap = lg.bot[0].r - lg.top[lg.top.length-1].r - 1;
      if (gap > 0) h += '<div class="lb-ellipsis">&middot;&middot;&middot; ' + gap + ' more dogs &middot;&middot;&middot;</div>';
    }

    lg.bot.forEach(function(d) {
      var dem = d.r > lg.size - lg.demoteN;
      h += '<div class="lb-row' + (dem?' demote':'') + '">';
      h += '<span class="rank">' + d.r + '</span><span class="name">' + d.n + '</span>';
      h += '<span class="steps">' + fmt(d.s) + '</span>';
      h += '<div class="zone"' + (dem?'':' style="background:transparent"') + '></div></div>';
    });

    h += '<div class="phone-footer">Green = promotion zone &middot; Red = demotion zone</div>';
    h += '</div></div>';
    return h;
  }

  window.showWeek = function(wk) {
    document.querySelectorAll('.week-tab').forEach(function(t,i) {
      t.classList.toggle('active', i===wk-1);
    });
    var w = WEEKS[wk], h = '';
    h += '<div class="week-summary">';
    w.chips.forEach(function(c) {
      h += '<div class="week-chip"><div class="dot" style="background:'+c.color+'"></div>'+c.text+'</div>';
    });
    h += '</div>';
    var total = w.outcomes.up + w.outcomes.stay + w.outcomes.down;
    h += '<div class="week-outcomes">';
    h += '<span style="color:var(--gray-400);font-weight:500;">' + total + ' dogs &rarr;</span> ';
    h += '<span class="up">&#x2191; ' + w.outcomes.up + ' promoted</span>';
    h += '<span class="hold">&ndash; ' + w.outcomes.stay + ' stayed</span>';
    h += '<span class="down">&#x2193; ' + w.outcomes.down + ' demoted</span>';
    h += '</div>';
    if (w.callout) h += '<div class="callout ' + w.callout.type + '">' + w.callout.html + '</div>';
    h += '<div class="league-boards">';
    w.leagues.forEach(function(lg) { h += renderLeague(lg); });
    h += '</div>';
    document.getElementById('weekContent').innerHTML = h;
  };
  showWeek(1);

  // JOURNEYS — now with push notification mockups
  var journeys = [
    { name:'Finn', arch:'The Rocket',
      desc:'Promoted every single week. 244K avg steps/week. Blew through every tier in 4 weeks.',
      notif:'Finn promoted to Diamond League! Top Golden Retriever in Austin.',
      steps:[{w:'W1',t:'bronze'},{w:'W2',t:'silver'},{w:'W3',t:'gold'},{w:'W4',t:'platinum'},{w:'End',t:'diamond'}]},
    { name:'Watson', arch:'The Breakout',
      desc:'Started at #16/38. Exploded with 202K steps in Week 2 and 264K in Week 3 to claim Gold.',
      notif:"Watson's best week ever \u2014 264,000 steps! Promoted to Gold.",
      steps:[{w:'W1',t:'bronze'},{w:'W2',t:'bronze'},{w:'W3',t:'silver'},{w:'W4',t:'gold'}]},
    { name:'Birdie', arch:'Steady Climber',
      desc:'Started at #23/38 in Bronze. Steady improvement: 94K, 121K, 151K, 158K. Earned Gold through consistency.',
      notif:"Birdie is #3 in Silver League with 2 days left. Keep it up!",
      steps:[{w:'W1',t:'bronze'},{w:'W2',t:'silver'},{w:'W3',t:'silver'},{w:'W4',t:'gold'}]},
    { name:'Telli', arch:'The Yo-Yo',
      desc:"Shot to Gold by Week 3, demoted when the league had only 2 dogs. Bounced back the next week.",
      notif:"Fresh start! Telli is back in Silver League. New week, new chance.",
      steps:[{w:'W1',t:'bronze'},{w:'W2',t:'silver'},{w:'W3',t:'gold'},{w:'W4',t:'silver'},{w:'End',t:'gold'}]}
  ];
  var emojis = {bronze:'&#x1F949;',silver:'&#x1F948;',gold:'&#x1F947;',platinum:'&#x1F48E;',diamond:'&#x1F451;'};
  var jg = document.getElementById('journeyGrid');
  journeys.forEach(function(j) {
    var h = '<div class="journey-card">';
    h += '<div class="dog-name">' + j.name + '</div>';
    h += '<div class="archetype">' + j.arch + '</div>';
    h += '<div class="desc">' + j.desc + '</div>';
    h += '<div class="notif"><span class="notif-label">Push</span> ' + j.notif + '</div>';
    h += '<div class="journey-timeline">';
    j.steps.forEach(function(s,i) {
      h += '<div class="journey-step"><div class="badge ' + s.t + '">' + emojis[s.t] + '</div><div class="wk">' + s.w + '</div></div>';
      if (i < j.steps.length-1) h += '<div class="journey-arrow">&rarr;</div>';
    });
    h += '</div></div>';
    jg.innerHTML += h;
  });

  // NAV SCROLL
  window.navJump = function(id) {
    var el = document.getElementById(id);
    if (el) {
      var y = el.getBoundingClientRect().top + window.pageYOffset - 72;
      window.scrollTo({top:y, behavior:'smooth'});
    }
  };
  var secs = ['simulation','problems','weekview','pooling','journeys','ship'];
  var navBtns = document.querySelectorAll('.nav-tab');
  window.addEventListener('scroll', function() {
    var active = 0;
    secs.forEach(function(id,i) {
      var el = document.getElementById(id);
      if (el && el.getBoundingClientRect().top <= 100) active = i;
    });
    navBtns.forEach(function(b,i) { b.classList.toggle('active', i===active); });
  });
})();
</script>
</body>
</html>
